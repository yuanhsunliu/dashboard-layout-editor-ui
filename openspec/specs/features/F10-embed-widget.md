# F10: Embed Widget

## Status
- [x] Completed

## Status History
| Date | Status | Notes |
|------|--------|-------|
| 2026-01-08 | âœ… Completed | Archived as 2026-01-08-add-embed-widget |
| 2026-01-08 | ğŸ”„ In Progress | Implementation started |
| 2026-01-08 | ğŸ“ Planned | Initial spec created |

## Overview
ä½¿ç”¨è€…å¯ä»¥é€é URL åµŒå…¥å¤–éƒ¨å ±è¡¨ï¼ˆå¦‚ Power BIã€Tableauã€Grafanaã€Metabase ç­‰ï¼‰è‡³ Dashboard ä¸­ï¼Œèˆ‡è‡ªå»ºçš„ Chart Widget ä¸¦å­˜ä½¿ç”¨ã€‚

## User Stories
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥é¸æ“‡ã€ŒåµŒå…¥å ±è¡¨ã€ä½œç‚º Widget é¡å‹ï¼Œä»¥ä¾¿åµŒå…¥å¤–éƒ¨å ±è¡¨
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥è¼¸å…¥å ±è¡¨ URLï¼Œä»¥ä¾¿åœ¨ Dashboard ä¸­é¡¯ç¤ºå¤–éƒ¨å ±è¡¨
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥è¨­å®š Widget æ¨™é¡Œï¼Œä»¥ä¾¿è­˜åˆ¥åµŒå…¥çš„å…§å®¹
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥å³æ™‚é è¦½åµŒå…¥æ•ˆæœï¼Œä»¥ä¾¿ç¢ºèª URL æ­£ç¢º

## Acceptance Criteria

### Widget é¡å‹é¸æ“‡
- [x] å°‡ã€Œåœ–è¡¨é¡å‹ã€é¸æ“‡å™¨æ”¹ç‚ºã€ŒWidget é¡å‹ã€é¸æ“‡å™¨
- [x] å¯é¸æ“‡ã€ŒåµŒå…¥å ±è¡¨ã€ä½œç‚º Widget é¡å‹
- [x] é¸æ“‡å¾Œé¡¯ç¤º Embed å°ˆå±¬è¨­å®šæ¬„ä½

### è¨­å®šæ¬„ä½
- [x] é¡¯ç¤º URL è¼¸å…¥æ¬„ä½ï¼ˆå¿…å¡«ï¼‰
- [x] é¡¯ç¤ºæ¨™é¡Œè¼¸å…¥æ¬„ä½ï¼ˆé¸å¡«ï¼Œé è¨­ã€ŒåµŒå…¥å ±è¡¨ã€ï¼‰
- [x] éš±è—è³‡æ–™ä¾†æºã€Xè»¸ã€Yè»¸ç­‰åœ–è¡¨ç›¸é—œæ¬„ä½

### URL é©—è­‰
- [x] å…è¨± HTTP å’Œ HTTPS URL
- [x] ç„¡æ•ˆ URL æ ¼å¼é¡¯ç¤ºé©—è­‰éŒ¯èª¤
- [x] ç„¡æ•ˆæ™‚ç„¡æ³•å„²å­˜è¨­å®š

### iframe åµŒå…¥
- [x] ä½¿ç”¨ iframe è¼‰å…¥è¨­å®šçš„ URL
- [x] iframe è‡ªå‹•å¡«æ»¿ Widget å€åŸŸ
- [x] ä¸è¨­ç½® sandbox å±¬æ€§é™åˆ¶
- [x] é¡¯ç¤º loading skeleton è¼‰å…¥ç‹€æ…‹
- [x] ä¸ä¸»å‹•åµæ¸¬åµŒå…¥å¤±æ•—

### é è¦½
- [x] è¼¸å…¥æœ‰æ•ˆ URL å¾Œå³æ™‚é¡¯ç¤ºé è¦½

### ç©ºç™½ç‹€æ…‹
- [x] æœªè¨­å®š URL æ™‚æ²¿ç”¨ Chart Widget ç©ºç™½ç‹€æ…‹æ¨£å¼

### æ¨™é¡Œé¡¯ç¤º
- [x] Widget æ¨™é¡Œåˆ—é¡¯ç¤ºä½¿ç”¨è€…è¨­å®šçš„æ¨™é¡Œ
- [x] æ¨™é¡Œç‚ºç©ºæ™‚é¡¯ç¤ºã€ŒåµŒå…¥å ±è¡¨ã€

## UI/UX Spec

### è¨­å®šé¢æ¿
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Widget è¨­å®š                  [X]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â”‚
â”‚  Widget é¡å‹                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ”— åµŒå…¥å ±è¡¨              â–¼  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                    â”‚
â”‚  æ¨™é¡Œ                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ åµŒå…¥å ±è¡¨                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  åµŒå…¥ç¶²å€ *                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ https://...                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                    â”‚
â”‚  é è¦½                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚      [iframe é è¦½]           â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚         [å–æ¶ˆ]    [å„²å­˜]           â”‚
â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Design Decisions

| é …ç›® | æ±ºå®š |
|------|------|
| URL å®‰å…¨æ€§ | å…è¨± HTTP å’Œ HTTPS |
| iframe æ¬Šé™ | ä¸è¨­ sandbox é™åˆ¶ |
| é è¦½è¡Œç‚º | å³æ™‚é è¦½ |
| è¼‰å…¥ç‹€æ…‹ | é¡¯ç¤º loading skeleton |
| éŒ¯èª¤åµæ¸¬ | ä¸ä¸»å‹•åµæ¸¬ |
| ç©ºç™½ç‹€æ…‹ | æ²¿ç”¨ Chart Widget æ¨£å¼ |
| UX æµç¨‹ | å°‡ã€Œåœ–è¡¨é¡å‹ã€æ”¹ç‚ºã€ŒWidget é¡å‹ã€ |
| æ¨™é¡Œé è¨­å€¼ | é è¨­ç‚ºã€ŒåµŒå…¥å ±è¡¨ã€ |
| æ¨™é¡Œåˆ—é¡¯ç¤º | é¡¯ç¤ºè¨­å®šæ¨™é¡Œï¼Œç©ºç™½å‰‡é¡¯ç¤ºã€ŒåµŒå…¥å ±è¡¨ã€ |

## Component Structure

```
src/features/chart-plugins/plugins/embed/
â”œâ”€â”€ index.ts              # Plugin å®šç¾©
â”œâ”€â”€ EmbedRenderer.tsx     # iframe åµŒå…¥å…ƒä»¶
â”œâ”€â”€ ConfigFields.tsx      # URL + æ¨™é¡Œè¨­å®šæ¬„ä½
â””â”€â”€ schema.ts             # Zod validation
```

## Form Validation (Zod)

```typescript
const embedSchema = z.object({
  chartType: z.literal('embed'),
  title: z.string().optional().default('åµŒå…¥å ±è¡¨'),
  url: z.string().url('è«‹è¼¸å…¥æœ‰æ•ˆçš„ç¶²å€'),
});
```

## Dependencies
- F09: Chart Plugin Systemï¼ˆPlugin æ¶æ§‹ï¼‰
- F04: Chart Configurationï¼ˆè¨­å®šé¢æ¿ï¼‰

## Out of Scope
- URL ç™½åå–®é™åˆ¶
- ä¸»å‹•åµæ¸¬ X-Frame-Options éŒ¯èª¤
- iframe sandbox å®‰å…¨é™åˆ¶
- åµŒå…¥å…§å®¹çš„äº’å‹•æ§åˆ¶
