# F04: Chart Configuration

## Overview
ä½¿ç”¨è€…å¯ä»¥é€éè¨­å®šé¢æ¿è¨­å®š Widget çš„åœ–è¡¨é¡å‹ã€è³‡æ–™ä¾†æºèˆ‡æ¬„ä½å°æ‡‰ã€‚

## User Stories
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥é¸æ“‡åœ–è¡¨é¡å‹ï¼Œä»¥ä¾¿å‘ˆç¾åˆé©çš„è¦–è¦ºåŒ–
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥é¸æ“‡è³‡æ–™ä¾†æºï¼Œä»¥ä¾¿ä½¿ç”¨æ­£ç¢ºçš„è³‡æ–™
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥è¨­å®š X/Y è»¸å°æ‡‰çš„æ¬„ä½ï¼Œä»¥ä¾¿æ­£ç¢ºå‘ˆç¾è³‡æ–™
- ä½œç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å¯ä»¥å³æ™‚é è¦½åœ–è¡¨æ•ˆæœ

## Acceptance Criteria

### é–‹å•Ÿè¨­å®šé¢æ¿
- [ ] é»æ“Šç©ºç™½ Widget é–‹å•Ÿè¨­å®šé¢æ¿
- [ ] é»æ“Šå·²è¨­å®š Widget çš„è¨­å®šæŒ‰éˆ•é–‹å•Ÿè¨­å®šé¢æ¿
- [ ] è¨­å®šé¢æ¿ä½¿ç”¨ Side Sheet æˆ– Dialog

### åœ–è¡¨é¡å‹é¸æ“‡
- [ ] å¯å¾åˆ—è¡¨é¸æ“‡åœ–è¡¨é¡å‹ (Line, Bar, ...)
- [ ] é¡¯ç¤ºåœ–è¡¨é¡å‹åœ–ç¤ºèˆ‡åç¨±
- [ ] åˆ‡æ›é¡å‹æ™‚é‡ç½®å°æ‡‰è¨­å®šæ¬„ä½

### è³‡æ–™ä¾†æºé¸æ“‡
- [ ] å¯å¾ä¸‹æ‹‰é¸å–®é¸æ“‡è³‡æ–™ä¾†æº
- [ ] é¸æ“‡å¾Œè¼‰å…¥è©²è³‡æ–™ä¾†æºçš„æ¬„ä½åˆ—è¡¨

### æ¬„ä½å°æ‡‰
- [ ] ä¾åœ–è¡¨é¡å‹é¡¯ç¤ºå°æ‡‰çš„è¨­å®šæ¬„ä½
- [ ] Line/Bar Chart: X è»¸æ¬„ä½ã€Y è»¸æ¬„ä½ï¼ˆå¯å¤šé¸ï¼‰
- [ ] Pie Chart: æ•¸å€¼æ¬„ä½ã€æ¨™ç±¤æ¬„ä½

### å³æ™‚é è¦½
- [ ] è¨­å®šè®Šæ›´æ™‚å³æ™‚æ›´æ–°é è¦½åœ–è¡¨
- [ ] é è¦½ä½¿ç”¨å¯¦éš›è³‡æ–™

### å„²å­˜èˆ‡å–æ¶ˆ
- [ ] é»æ“Šã€Œå„²å­˜ã€å¥—ç”¨è¨­å®šä¸¦é—œé–‰é¢æ¿
- [ ] é»æ“Šã€Œå–æ¶ˆã€æ”¾æ£„è®Šæ›´ä¸¦é—œé–‰é¢æ¿

## UI/UX Spec

### è¨­å®šé¢æ¿ (Side Sheet)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åœ–è¡¨è¨­å®š                    [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â”‚
â”‚  åœ–è¡¨é¡å‹                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“ˆ æŠ˜ç·šåœ–              â–¼    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  è³‡æ–™ä¾†æº                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ é¸æ“‡è³‡æ–™ä¾†æº...          â–¼  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                    â”‚
â”‚  X è»¸æ¬„ä½                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ date                     â–¼  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  Y è»¸æ¬„ä½                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â˜‘ revenue                   â”‚  â”‚
â”‚  â”‚ â˜‘ profit                    â”‚  â”‚
â”‚  â”‚ â˜ cost                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                    â”‚
â”‚  é è¦½                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚      ğŸ“ˆ (å³æ™‚é è¦½åœ–è¡¨)       â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚         [å–æ¶ˆ]    [å„²å­˜]           â”‚
â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åœ–è¡¨é¡å‹é¸é …
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ˆ æŠ˜ç·šåœ–                    â”‚
â”‚ ğŸ“Š é•·æ¢åœ–                    â”‚
â”‚ ğŸ¥§ åœ“é¤…åœ– (Phase 2)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Dynamic Form Fields

æ ¹æ“š chartType å‹•æ…‹é¡¯ç¤ºä¸åŒè¨­å®šæ¬„ä½ï¼š

| chartType | è¨­å®šæ¬„ä½ |
|-----------|----------|
| line | xAxisField, yAxisFields[], smooth |
| bar | xAxisField, yAxisFields[], stacked, horizontal |
| pie | valueField, labelField, showLegend |

## Component Structure

```
src/features/chart-config/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ChartConfigPanel.tsx      # è¨­å®šé¢æ¿å®¹å™¨
â”‚   â”œâ”€â”€ ChartTypeSelector.tsx     # åœ–è¡¨é¡å‹é¸æ“‡
â”‚   â”œâ”€â”€ DataSourceSelector.tsx    # è³‡æ–™ä¾†æºé¸æ“‡
â”‚   â”œâ”€â”€ FieldMapping/
â”‚   â”‚   â”œâ”€â”€ LineChartFields.tsx   # Line Chart æ¬„ä½
â”‚   â”‚   â”œâ”€â”€ BarChartFields.tsx    # Bar Chart æ¬„ä½
â”‚   â”‚   â””â”€â”€ PieChartFields.tsx    # Pie Chart æ¬„ä½
â”‚   â””â”€â”€ ChartPreview.tsx          # å³æ™‚é è¦½
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useChartConfig.ts         # è¨­å®šé‚è¼¯
â””â”€â”€ types.ts
```

## Form Validation (Zod)

```typescript
const lineChartSchema = z.object({
  chartType: z.literal('line'),
  title: z.string().optional(),
  dataSourceId: z.string().min(1, 'è«‹é¸æ“‡è³‡æ–™ä¾†æº'),
  xAxisField: z.string().min(1, 'è«‹é¸æ“‡ X è»¸æ¬„ä½'),
  yAxisFields: z.array(z.string()).min(1, 'è«‹è‡³å°‘é¸æ“‡ä¸€å€‹ Y è»¸æ¬„ä½'),
  smooth: z.boolean().optional(),
});

const barChartSchema = z.object({
  chartType: z.literal('bar'),
  title: z.string().optional(),
  dataSourceId: z.string().min(1, 'è«‹é¸æ“‡è³‡æ–™ä¾†æº'),
  xAxisField: z.string().min(1, 'è«‹é¸æ“‡ X è»¸æ¬„ä½'),
  yAxisFields: z.array(z.string()).min(1, 'è«‹è‡³å°‘é¸æ“‡ä¸€å€‹ Y è»¸æ¬„ä½'),
  stacked: z.boolean().optional(),
  horizontal: z.boolean().optional(),
});
```

## Dependencies
- T01: Project Setup
- F02: Widget Layoutï¼ˆWidget é»æ“Šäº‹ä»¶ï¼‰
- F03: Chart Renderingï¼ˆé è¦½åŠŸèƒ½ï¼‰
- F06: Data Sourceï¼ˆè³‡æ–™ä¾†æºé¸æ“‡ï¼‰- å¯å…ˆç”¨ Mock

## Out of Scope
- é€²éšåœ–è¡¨è¨­å®šï¼ˆé¡è‰²ã€å­—å‹ã€å‹•ç•«ï¼‰
- è‡ªè¨‚ ECharts option
- è¨­å®šç¯„æœ¬/é è¨­å€¼
